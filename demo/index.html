<html>

<head>
  <script type="text/javascript" src="../../webcomponentsjs/webcomponents-lite.js"></script>
  <link rel="import" href="../../iron-demo-helpers/demo-snippet.html">
  <link rel="import" href="../../iron-demo-helpers/demo-pages-shared-styles.html">
  <link rel="import" href="../../paper-input/paper-input.html">
  <link rel="import" href="../../paper-checkbox/paper-checkbox.html">
  <link rel="import" href="../../paper-button/paper-button.html">

  <link rel="import" href="../iron-grid.html">

  <style is="custom-style" include="demo-pages-shared-styles">
    .vertical-section-container {
      max-width: 500px;
    }

    paper-button {
      margin-left: 10px;
      margin-right: 10px;
    }
  </style>
</head>

<body>
  <div class="vertical-section-container centered">
    <style>
      .centered {
        max-width: 800px;
      }
    </style>

    <h4>Basic Template Support</h4>
    <demo-snippet>
      <template>
        <style>
          #grid1 .custom {
            color: red;
          }
        </style>

        <iron-grid id="grid1">
          <grid-column name="First Name">
            <template>
              <div class="custom">[[item.user.name.first]]</div>
            </template>
          </grid-column>
          <grid-column name="Last Name">
            <template>[[item.user.name.last]]</template>
          </grid-column>
          <grid-column name="Email">
            <template>[[item.user.email]]</template>
          </grid-column>
        </iron-grid>
      </template>
    </demo-snippet>

    <h4>Two-Way Binding Support</h4>
    <demo-snippet>
      <template>

        <template is="dom-bind" id="t" foo="bar">
          <style is="custom-style">
            paper-input {
              margin-bottom: 20px;
              --paper-input-container-label: {
                font-size: inherit;
              }
            }
          </style>
          <iron-grid items="[[users]]">
            <grid-column name="First Name">
              <template>
                <paper-input value="{{foo}}"></paper-input>
              </template>
            </grid-column>
            <grid-column name="Last Name">
              <template>
                <paper-input value="{{item.user.name.last}}"></paper-input>
              </template>
            </grid-column>
            <grid-column name="Email">
              <template>[[item.user.email]]</template>
            </grid-column>
          </iron-grid>
        </template>
      </template>
    </demo-snippet>

    <h4>Variable Row Height</h4>
    <demo-snippet>
      <template>
        <template is="dom-bind">
          <style is="custom-style">
            #grid2 {
              --iron-grid-row-height: auto;
            }
          </style>

          <style>
            #grid2 .hawaii {
              display: flex;
              align-items: center;
              height: 40px;
            }

            #grid2 .iowa {
              display: flex;
              align-items: center;
              height: 80px;
            }
          </style>

          <iron-grid id="grid2">
            <grid-column name="First Name">
              <template>[[item.user.name.first]]</template>
            </grid-column>
            <grid-column name="Last Name">
              <template>[[item.user.name.last]]</template>
            </grid-column>
            <grid-column name="State">
              <template>
                <div class$="[[item.user.location.state]]">[[item.user.location.state]]</div>
              </template>
            </grid-column>
          </iron-grid>
        </template>
      </template>
    </demo-snippet>

    <h3>Column Resizing (adding flex property is in progress)</h3>
    <demo-snippet>
      <template>
        <template is="dom-bind">
          <paper-input id="resize" label="1st Column Width" value="{{width}}"></paper-input>
          <iron-grid id="grid3">
            <grid-column name="First Name" width="[[width]]">
              <template>[[item.user.name.first]]</template>
            </grid-column>
            <grid-column name="Last Name">
              <template>[[item.user.name.last]]</template>
            </grid-column>
            <grid-column name="Email">
              <template>[[item.user.email]]</template>
            </grid-column>
          </iron-grid>
        </template>
      </template>
    </demo-snippet>

    <h3>Lazy Loading (experimental, work in progress)</h3>
    <demo-snippet>
      <template>
        <script>
        /**
         * function(index, count) {
         *  return users.slice(index, index + count);
         * };
         */
        </script>
        <iron-grid id="grid4" size="200">
          <grid-column name="First Name">
            <template>[[item.user.name.first]]</template>
          </grid-column>
          <grid-column name="Last Name">
            <template>[[item.user.name.last]]</template>
          </grid-column>
          <grid-column name="Email">
            <template>[[item.user.email]]</template>
          </grid-column>
        </iron-grid>
      </template>
    </demo-snippet>

    <h3>Column Hiding</h3>
    <demo-snippet>
      <template>
        <template is="dom-bind">
          nicely placed checkbox (show/hide 1st column)
          <paper-checkbox id="hide" checked="{{checked}}"></paper-checkbox>
          <iron-grid id="grid5">
            <grid-column name="First Name" hidden="[[!checked]]">
              <template>[[item.user.name.first]]</template>
            </grid-column>
            <grid-column name="Last Name">
              <template>[[item.user.name.last]]</template>
            </grid-column>
            <grid-column name="Email">
              <template>[[item.user.email]]</template>
            </grid-column>
          </iron-grid>
        </template>
      </template>
    </demo-snippet>

    <h3>Column Reordering (using flexbox order)</h3>
    <demo-snippet>
      <template>
        <paper-button id="reorder">Move 1st Column to 2nd</paper-button>
        <script>
          document.querySelector('#reorder').addEventListener('tap', function(e) {
            var grid = document.querySelector('#grid6');

            grid.columns[0].order = grid.columns[0].order ? 0 : 1;

            // Modifying columns array order doesn't work nicely. See https://github.com/Polymer/polymer/issues/2752
            //var col = grid.shift('columns');
            //grid.push('columns', col);
            //this requires doing grid.columns = undefined; grid.columns = columns;
          });
        </script>
        <iron-grid id="grid6">
          <grid-column name="First Name">
            <template>[[item.user.name.first]]</template>
          </grid-column>
          <grid-column name="Last Name">
            <template>[[item.user.name.last]]</template>
          </grid-column>
          <grid-column name="Email" order="2">
            <template>[[item.user.email]]</template>
          </grid-column>
        </iron-grid>
      </template>
    </demo-snippet>

    <h3>Filtering (work in progress, iron-list rendering issues in Shadow DOM)</h3>
    <demo-snippet>
      <template>
        <iron-grid id="grid7">
          <grid-column name="First Name" filter="user.name.first">
            <template>[[item.user.name.first]]</template>
          </grid-column>
          <grid-column name="Last Name" filter="user.name.last">
            <template>[[item.user.name.last]]</template>
          </grid-column>
          <grid-column name="Email">
            <template>[[item.user.email]]</template>
          </grid-column>
        </iron-grid>
      </template>
    </demo-snippet>
  </div>

  <script>
    var users;
    document.addEventListener('WebComponentsReady', function() {

      var xhr = new XMLHttpRequest();
      xhr.onreadystatechange = function() {
        if (xhr.readyState == XMLHttpRequest.DONE) {
          if (xhr.status == 200) {
            var json = JSON.parse(xhr.responseText);
            users = json.results;

            document.querySelector('#t').users = users;
            document.querySelector('#grid1').items = users;
            document.querySelector('#grid2').items = users;
            document.querySelector('#grid3').items = users;
            document.querySelector('#grid5').items = users;
            document.querySelector('#grid6').items = users;
            document.querySelector('#grid7').items = users;

            document.querySelector('#grid4').lazyItems = function(index, count) {
              return users.slice(index, index + count);
            };
          }
        }
      };

      xhr.open("GET", 'users.json', true);
      xhr.send();
    });
  </script>
</body>

</html>
